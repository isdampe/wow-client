const wowMemClient = require('./../../lib/mem-client.js');
const wowControl = require('./../../lib/wow-control.js');

var client = new wowMemClient( 'localhost', 8888 );
var controller = new wowControl( () => {
  return client.getMemory();
} );

//Stormwind...
var points = [
  {
    "x": 2162.45874,
    "y": 230.468826,
    "z": 43.800159
  },
  {
    "x": 2139.665039,
    "y": 243.796341,
    "z": 43.800159
  },
  {
    "x": 2117.765869,
    "y": 256.600952,
    "z": 43.795635
  },
  {
    "x": 2091.334473,
    "y": 272.055481,
    "z": 43.792652
  },
  {
    "x": 2080.749268,
    "y": 253.209793,
    "z": 43.793957
  },
  {
    "x": 2068.923584,
    "y": 227.612793,
    "z": 43.790482
  },
  {
    "x": 2047.609741,
    "y": 231.763702,
    "z": 37.510281
  },
  {
    "x": 2023.198608,
    "y": 244.387482,
    "z": 24.0825
  },
  {
    "x": 1998.543945,
    "y": 261.424133,
    "z": 10.13713
  },
  {
    "x": 1971.266357,
    "y": 275.107178,
    "z": -1.639077
  },
  {
    "x": 1945.526367,
    "y": 286.478638,
    "z": -10.659161
  },
  {
    "x": 1926.030762,
    "y": 304.946747,
    "z": -17.754461
  },
  {
    "x": 1900.438232,
    "y": 314.364502,
    "z": -21.889753
  },
  {
    "x": 1871.609375,
    "y": 316.078033,
    "z": -25.965288
  },
  {
    "x": 1839.085571,
    "y": 317.568604,
    "z": -24.493267
  },
  {
    "x": 1804.831543,
    "y": 317.048462,
    "z": -24.812775
  },
  {
    "x": 1771.462646,
    "y": 320.798035,
    "z": -17.022385
  },
  {
    "x": 1737.294434,
    "y": 330.455322,
    "z": -12.158478
  },
  {
    "x": 1694.938843,
    "y": 336.189819,
    "z": -4.829389
  },
  {
    "x": 1664.52124,
    "y": 339.539917,
    "z": -0.881726
  },
  {
    "x": 1637.758057,
    "y": 331.713135,
    "z": 0.487904
  },
  {
    "x": 1627.788208,
    "y": 309.045349,
    "z": 0.416627
  },
  {
    "x": 1611.529419,
    "y": 289.520416,
    "z": 0.205063
  },
  {
    "x": 1580.429932,
    "y": 286.950226,
    "z": 0.066094
  },
  {
    "x": 1572.888794,
    "y": 271.459625,
    "z": 1.13472
  },
  {
    "x": 1581.220459,
    "y": 247.057831,
    "z": 2.09741
  },
  {
    "x": 1591.223145,
    "y": 220.670349,
    "z": 0.899634
  },
  {
    "x": 1599.750977,
    "y": 198.407135,
    "z": 1.891555
  },
  {
    "x": 1616.20813,
    "y": 190.582245,
    "z": 0.969671
  },
  {
    "x": 1638.752075,
    "y": 191.441238,
    "z": -2.62517
  },
  {
    "x": 1663.220215,
    "y": 188.862366,
    "z": -2.509876
  },
  {
    "x": 1684.169067,
    "y": 179.121231,
    "z": -3.752564
  },
  {
    "x": 1713.698608,
    "y": 180.00264,
    "z": -12.018972
  },
  {
    "x": 1751.38208,
    "y": 178.81044,
    "z": -17.560867
  },
  {
    "x": 1776.528564,
    "y": 183.702026,
    "z": -16.161797
  },
  {
    "x": 1801.833374,
    "y": 201.908554,
    "z": -19.424196
  },
  {
    "x": 1823.479614,
    "y": 218.790024,
    "z": -22.438379
  },
  {
    "x": 1847.841675,
    "y": 240.335373,
    "z": -30.814695
  },
  {
    "x": 1872.403198,
    "y": 265.336639,
    "z": -27.39706
  },
  {
    "x": 1892.297119,
    "y": 276.866425,
    "z": -22.614048
  },
  {
    "x": 1933.874268,
    "y": 288.936829,
    "z": -14.88014
  },
  {
    "x": 1965.803711,
    "y": 281.708282,
    "z": -4.428345
  },
  {
    "x": 2002.266357,
    "y": 259.119446,
    "z": 12.260921
  },
  {
    "x": 2034.080444,
    "y": 238.836014,
    "z": 30.022673
  },
  {
    "x": 2064.852783,
    "y": 219.21698,
    "z": 43.787666
  },
  {
    "x": 2095.140625,
    "y": 219.832611,
    "z": 43.645344
  },
  {
    "x": 2110.592773,
    "y": 224.286835,
    "z": 43.666119
  },
  {
    "x": 2125.730713,
    "y": 223.776657,
    "z": 43.641037
  },
  {
    "x": 2137.310303,
    "y": 217.806244,
    "z": 43.648567
  },
  {
    "x": 2149.959229,
    "y": 208.007935,
    "z": 43.649757
  },
  {
    "x": 2154.96167,
    "y": 214.932343,
    "z": 43.649757
  }
];

var currentPoint = 0;
var maxPoints = points.length;

var autoWalkToPoint = ( i ) => {

  console.log('point ' + i);
  if ( i >= maxPoints ) {
    console.log('done');
    process.exit(0);
  }

  var cp = points[i];
  controller.walkTo( cp.x, cp.y, () => {
    autoWalkToPoint( i + 1 );
  } )

};

setTimeout(() => {
    autoWalkToPoint( 0 );
},1000);

/*
setTimeout(() => {
  controller.walkTo( -9087.443359, 417.471130, () => {
    console.log('I made it!');
  } );
}, 1000);
*/
